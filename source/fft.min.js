// (c) 2015 Mark Huckvale University College London
function RealFFT(){var w=this.constructor.prototype;w.four1=function(e,t){var a,g,f,b,q,d,n,r,p,l,k,h;a=t<<1;for(d=b=1;d<a;d+=2){b>d&&(k=e[b],e[b]=e[d],e[d]=k,h=e[b+1],e[b+1]=e[d+1],e[d+1]=h);for(f=a>>1;2<=f&&b>f;)b-=f,f>>=1;b+=f}for(g=2;a>g;){q=2*g;f=2*Math.PI/g;b=Math.sin(.5*f);r=-2*b*b;p=Math.sin(f);n=1;l=0;for(f=1;f<g;f+=2){for(d=f;d<=a;d+=q)b=d+g,k=n*e[b]-l*e[b+1],h=n*e[b+1]+l*e[b],e[b]=e[d]-k,e[b+1]=e[d+1]-h,e[d]+=k,e[d+1]+=h;n=(b=n)*r-l*p+n;l=l*r+b*p+l}g=q}};w.RealFFTPower=function(e,t){for(var a,
g,f,b,q,d,n,r,p,l,k,h,u,v,c,x,m=2;m<t;)m*=2;c=new Float32Array(m+1);for(a=1;a<=t;a++)c[a]=e[a-1];for(;a<=m;a++)c[a]=0;m>>=1;x=new Float32Array(m);a=Math.PI/m;w.four1(c,m);g=Math.sin(.5*a);u=-2*g*g;v=Math.sin(a);k=1+u;h=v;d=2*m+3;for(a=2;a<=m/2;a++)q=1+(b=d-(f=1+(g=a+a-1))),n=.5*(c[g]+c[b]),r=.5*(c[f]-c[q]),p=.5*(c[f]+c[q]),l=-.5*(c[g]-c[b]),c[g]=n+k*p-h*l,c[f]=r+k*l+h*p,c[b]=n-k*p+h*l,c[q]=-r+k*l+h*p,k=(g=k)*u-h*v+k,h=h*u+g*v+h;c[2]=0;c[1]=(n=c[1])+c[2];c[2]=n-c[2];for(a=0;a<m;a++)x[a]=Math.sqrt(c[2*
a+1]*c[2*a+1]+c[2*a+2]*c[2*a+2]);return x}};